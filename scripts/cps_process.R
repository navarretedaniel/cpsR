# cpsR
# cps_process
# Author:  Daniel Navarrete <https://github.com/navarretedaniel>
# 2019

# Introduction -----------------------------------------------------------------
#
# Creates a function that converts CPS .dat file(s) into CSV file(s).
#
# Example:
#    cps_process(2018)

# Function ---------------------------------------------------------------------

cps_process <- function(year){
  input_year <<- as.character(substr(year, 3, 4))
  files <- as.vector(list.files(pattern = "\\.dat$"))

  input <- paste0(input_year, "pub.dat$")

  # Create a list of files matching our CPS year.
  files <- list.files(path = "data", pattern = input, full.names = TRUE)

  # Clean-up file name text.
  i = 1
  for (file_name in files){
    file_name_short <- gsub("data/", "", file_name)
    files[i] <- file_name
    i = i+1}

  # Process CPS .dat file into CSV.

  if (year < 2014 || year > 2019) {
      print("ERROR:  Please enter a single year (e.g., 2018) between the year range 2014 - 2019.")

  } else if (length(files) == 0) {
      print("ERROR:  Data for the given year not found. Download data using the download_cps() function.")

  } else {
    for (file_name in files) {

      print(paste0('>1 Reading CPS file ', file_name_short, ' into memory.'))

      cps_file <- if (year == 2014) {
          read_fwf(file_name, fwf_cols(hrhhid = c(1,15),
                                     hrmonth = c(16,17),
                                     hryear4 = c(18,21),
                                     hurespli = c(22,23),
                                     hufinal = c(24,26),
                                     huspnish = c(27,28),
                                     hetenure = c(29,30),
                                     hehousut = c(31,32),
                                     hetelhhd = c(33,34),
                                     hetelavl = c(35,36),
                                     hephoneo = c(37,38),
                                     hefaminc = c(39,40),
                                     hutypea = c(41,42),
                                     hutypb = c(43,44),
                                     hutypc = c(45,46),
                                     hwhhwgt = c(47,56),
                                     hrintsta = c(57,58),
                                     hrnumhou = c(59,60),
                                     hrhtype = c(61,62),
                                     hrmis = c(63,64),
                                     huinttyp = c(65,66),
                                     huprscnt = c(67,68),
                                     hrlonglk = c(69,70),
                                     hrhhid2 = c(71,75),
                                     hubus = c(79,80),
                                     hubusl1 = c(81,82),
                                     hubusl2 = c(83,84),
                                     hubusl3 = c(85,86),
                                     hubusl4 = c(87,88),
                                     gereg = c(89,90),
                                     gestcen = c(91,92),
                                     gestfips = c(93,94),
                                     gtcbsa = c(96,100),
                                     gtco = c(101,103),
                                     gtcbsast = c(104,104),
                                     gtmetsta = c(105,105),
                                     gtindvpc = c(106,106),
                                     gtcbsasz = c(107,107),
                                     gtcsa = c(108,110),
                                     proldrrp = c(114,115),
                                     pupelig = c(116,117),
                                     perrp = c(118,119),
                                     peparent = c(120,121),
                                     prtage = c(122,123),
                                     prtfage = c(124,124),
                                     pemaritl = c(125,126),
                                     pespouse = c(127,128),
                                     pesex = c(129,130),
                                     peafever = c(131,132),
                                     peafnow = c(135,136),
                                     peeduca = c(137,138),
                                     ptdtrace = c(139,140),
                                     prdthsp = c(141,142),
                                     puchinhh = c(143,144),
                                     pulineno = c(147,148),
                                     prfamnum = c(151,152),
                                     prfamrel = c(153,154),
                                     prfamtyp = c(155,156),
                                     pehspnon = c(157,158),
                                     prmarsta = c(159,160),
                                     prpertyp = c(161,162),
                                     penatvty = c(163,165),
                                     pemntvty = c(166,168),
                                     pefntvty = c(169,171),
                                     prcitshp = c(172,173),
                                     prcitflg = c(174,175),
                                     prinusyr = c(176,177),
                                     puslfprx = c(178,179),
                                     pemlr = c(180,181),
                                     puwk = c(182,183),
                                     pubus1 = c(184,185),
                                     pubus2ot = c(186,187),
                                     pubusck1 = c(188,189),
                                     pubusck2 = c(190,191),
                                     pubusck3 = c(192,193),
                                     pubusck4 = c(194,195),
                                     puretot = c(196,197),
                                     pudis = c(198,199),
                                     peret1 = c(200,201),
                                     pudis1 = c(202,203),
                                     pudis2 = c(204,205),
                                     puabsot = c(206,207),
                                     pulay = c(208,209),
                                     peabsrsn = c(210,211),
                                     peabspdo = c(212,213),
                                     pemjot = c(214,215),
                                     pemjnum = c(216,217),
                                     pehrusl1 = c(218,219),
                                     pehrusl2 = c(220,221),
                                     pehrftpt = c(222,223),
                                     pehruslt = c(224,226),
                                     pehrwant = c(227,228),
                                     pehrrsn1 = c(229,230),
                                     pehrrsn2 = c(231,232),
                                     pehrrsn3 = c(233,234),
                                     puhroff1 = c(235,236),
                                     puhroff2 = c(237,238),
                                     puhrot1 = c(239,240),
                                     puhrot2 = c(241,242),
                                     pehract1 = c(243,244),
                                     pehract2 = c(245,246),
                                     pehractt = c(247,249),
                                     pehravl = c(250,251),
                                     puhrck1 = c(257,258),
                                     puhrck2 = c(259,260),
                                     puhrck3 = c(261,262),
                                     puhrck4 = c(263,264),
                                     puhrck5 = c(265,266),
                                     puhrck6 = c(267,268),
                                     puhrck7 = c(269,270),
                                     puhrck12 = c(271,272),
                                     pulaydt = c(273,274),
                                     pulay6m = c(275,276),
                                     pelayavl = c(277,278),
                                     pulayavr = c(279,280),
                                     pelaylk = c(281,282),
                                     pelaydur = c(283,285),
                                     pelayfto = c(286,287),
                                     pulayck1 = c(288,289),
                                     pulayck2 = c(290,291),
                                     pulayck3 = c(292,293),
                                     pulk = c(294,295),
                                     pelkm1 = c(296,297),
                                     pulkm2 = c(298,299),
                                     pulkm3 = c(300,301),
                                     pulkm4 = c(302,303),
                                     pulkm5 = c(304,305),
                                     pulkm6 = c(306,307),
                                     pulkdk1 = c(308,309),
                                     pulkdk2 = c(310,311),
                                     pulkdk3 = c(312,313),
                                     pulkdk4 = c(314,315),
                                     pulkdk5 = c(316,317),
                                     pulkdk6 = c(318,319),
                                     pulkps1 = c(320,321),
                                     pulkps2 = c(322,323),
                                     pulkps3 = c(324,325),
                                     pulkps4 = c(326,327),
                                     pulkps5 = c(328,329),
                                     pulkps6 = c(330,331),
                                     pelkavl = c(332,333),
                                     pulkavr = c(334,335),
                                     pelkll1o = c(336,337),
                                     pelkll2o = c(338,339),
                                     pelklwo = c(340,341),
                                     pelkdur = c(342,344),
                                     pelkfto = c(345,346),
                                     pedwwnto = c(347,348),
                                     pedwrsn = c(349,350),
                                     pedwlko = c(351,352),
                                     pedwwk = c(353,354),
                                     pedw4wk = c(355,356),
                                     pedwlkwk = c(357,358),
                                     pedwavl = c(359,360),
                                     pedwavr = c(361,362),
                                     pudwck1 = c(363,364),
                                     pudwck2 = c(365,366),
                                     pudwck3 = c(367,368),
                                     pudwck4 = c(369,370),
                                     pudwck5 = c(371,372),
                                     pejhwko = c(373,374),
                                     pujhdp1o = c(375,376),
                                     pejhrsn = c(377,378),
                                     pejhwant = c(379,380),
                                     pujhck1 = c(381,382),
                                     pujhck2 = c(383,384),
                                     prabsrea = c(385,386),
                                     prcivlf = c(387,388),
                                     prdisc = c(389,390),
                                     premphrs = c(391,392),
                                     prempnot = c(393,394),
                                     prexplf = c(395,396),
                                     prftlf = c(397,398),
                                     prhrusl = c(399,400),
                                     prjobsea = c(401,402),
                                     prpthrs = c(403,404),
                                     prptrea = c(405,406),
                                     prunedur = c(407,409),
                                     pruntype = c(412,413),
                                     prwksch = c(414,415),
                                     prwkstat = c(416,417),
                                     prwntjob = c(418,419),
                                     pujhck3 = c(420,421),
                                     pujhck4 = c(422,423),
                                     pujhck5 = c(424,425),
                                     puiodp1 = c(426,427),
                                     puiodp2 = c(428,429),
                                     puiodp3 = c(430,431),
                                     peio1cow = c(432,433),
                                     puio1mfg = c(434,435),
                                     peio2cow = c(442,443),
                                     puio2mfg = c(444,445),
                                     puiock1 = c(452,453),
                                     puiock2 = c(454,455),
                                     puiock3 = c(456,457),
                                     prioelg = c(458,459),
                                     pragna = c(460,461),
                                     prcow1 = c(462,463),
                                     prcow2 = c(464,465),
                                     prcowpg = c(466,467),
                                     prdtcow1 = c(468,469),
                                     prdtcow2 = c(470,471),
                                     prdtind1 = c(472,473),
                                     prdtind2 = c(474,475),
                                     prdtocc1 = c(476,477),
                                     prdtocc2 = c(478,479),
                                     premp = c(480,481),
                                     prmjind1 = c(482,483),
                                     prmjind2 = c(484,485),
                                     prmjocc1 = c(486,487),
                                     prmjocc2 = c(488,489),
                                     prmjocgr = c(490,491),
                                     prnagpws = c(492,493),
                                     prnagws = c(494,495),
                                     prsjmj = c(496,497),
                                     prerelg = c(498,499),
                                     peernuot = c(500,501),
                                     peernper = c(502,503),
                                     peernrt = c(504,505),
                                     peernhry = c(506,507),
                                     puernh1c = c(508,511),
                                     peernh2 = c(512,515),
                                     peernh1o = c(516,519),
                                     prernhly = c(520,523),
                                     pthr = c(524,524),
                                     peernhro = c(525,526),
                                     prernwa = c(527,534),
                                     ptwk = c(535,535),
                                     peern = c(540,547),
                                     puern2 = c(548,555),
                                     ptot = c(556,556),
                                     peernwkp = c(559,560),
                                     peernlab = c(561,562),
                                     peerncov = c(563,564),
                                     penlfjh = c(565,566),
                                     penlfret = c(567,568),
                                     penlfact = c(569,570),
                                     punlfck1 = c(571,572),
                                     punlfck2 = c(573,574),
                                     peschenr = c(575,576),
                                     peschft = c(577,578),
                                     peschlvl = c(579,580),
                                     prnlfsch = c(581,582),
                                     pwfmwgt = c(583,592),
                                     pwlgwgt = c(593,602),
                                     pworwgt = c(603,612),
                                     pwsswgt = c(613,622),
                                     pwvetwgt = c(623,632),
                                     prchld = c(633,634),
                                     prnmchld = c(635,636),
                                     prwernal = c(639,640),
                                     prhernal = c(641,642),
                                     hxtenure = c(643,644),
                                     hxhousut = c(645,646),
                                     hxtelhhd = c(647,648),
                                     hxtelavl = c(649,650),
                                     hxphoneo = c(651,652),
                                     pxinusyr = c(653,654),
                                     pxrrp = c(655,656),
                                     pxparent = c(657,658),
                                     pxage = c(659,660),
                                     pxmaritl = c(661,662),
                                     pxspouse = c(663,664),
                                     pxsex = c(665,666),
                                     pxafwhn1 = c(667,668),
                                     pxafnow = c(669,670),
                                     pxeduca = c(671,672),
                                     pxrace1 = c(673,674),
                                     pxnatvty = c(675,676),
                                     pxmntvty = c(677,678),
                                     pxfntvty = c(679,680),
                                     pxhspnon = c(683,684),
                                     pxmlr = c(685,686),
                                     pxret1 = c(687,688),
                                     pxabspdo = c(691,692),
                                     pxmjot = c(693,694),
                                     pxmjnum = c(695,696),
                                     pxhrusl1 = c(697,698),
                                     pxhrusl2 = c(699,700),
                                     pxhrftpt = c(701,702),
                                     pxhruslt = c(703,704),
                                     pxhrwant = c(705,706),
                                     pxhrrsn1 = c(707,708),
                                     pxhrrsn2 = c(709,710),
                                     pxhract1 = c(711,712),
                                     pxhract2 = c(713,714),
                                     pxhractt = c(715,716),
                                     pxhrrsn3 = c(717,718),
                                     pxhravl = c(719,720),
                                     pxlayavl = c(721,722),
                                     pxlaylk = c(723,724),
                                     pxlaydur = c(725,726),
                                     pxlayfto = c(727,728),
                                     pxlkm1 = c(729,730),
                                     pxlkavl = c(731,732),
                                     pxlkll1o = c(733,734),
                                     pxlkll2o = c(735,736),
                                     pxlklwo = c(737,738),
                                     pxlkdur = c(739,740),
                                     pxlkfto = c(741,742),
                                     pxdwwnto = c(743,744),
                                     pxdwrsn = c(745,746),
                                     pxdwlko = c(747,748),
                                     pxdwwk = c(749,750),
                                     pxdw4wk = c(751,752),
                                     pxdwlkwk = c(753,754),
                                     pxdwavl = c(755,756),
                                     pxdwavr = c(757,758),
                                     pxjhwko = c(759,760),
                                     pxjhrsn = c(761,762),
                                     pxjhwant = c(763,764),
                                     pxio1cow = c(765,766),
                                     pxio1icd = c(767,768),
                                     pxio1ocd = c(769,770),
                                     pxio2cow = c(771,772),
                                     pxio2icd = c(773,774),
                                     pxio2ocd = c(775,776),
                                     pxernuot = c(777,778),
                                     pxernper = c(779,780),
                                     pxernh1o = c(781,782),
                                     pxernhro = c(783,784),
                                     pxern = c(785,786),
                                     pxernwkp = c(791,792),
                                     pxernrt = c(793,794),
                                     pxernhry = c(795,796),
                                     pxernh2 = c(797,798),
                                     pxernlab = c(799,800),
                                     pxerncov = c(801,802),
                                     pxnlfjh = c(803,804),
                                     pxnlfret = c(805,806),
                                     pxnlfact = c(807,808),
                                     pxschenr = c(809,810),
                                     pxschft = c(811,812),
                                     pxschlvl = c(813,814),
                                     qstnum = c(815,819),
                                     occurnum = c(820,821),
                                     pedipged = c(822,823),
                                     pehgcomp = c(824,825),
                                     pecyc = c(826,827),
                                     pegrprof = c(828,829),
                                     pegr6cor = c(830,831),
                                     pems123 = c(832,833),
                                     pxdipged = c(834,835),
                                     pxhgcomp = c(836,837),
                                     pxcyc = c(838,839),
                                     pxgrprof = c(840,841),
                                     pxgr6cor = c(842,843),
                                     pxms123 = c(844,845),
                                     pwcmpwgt = c(846,855),
                                     peio1icd = c(856,859),
                                     peio1ocd = c(860,863),
                                     peio2icd = c(864,867),
                                     peio2ocd = c(868,871),
                                     primind1 = c(872,873),
                                     primind2 = c(874,875),
                                     peafwhn1 = c(876,877),
                                     peafwhn2 = c(878,879),
                                     peafwhn3 = c(880,881),
                                     peafwhn4 = c(882,883),
                                     pxafever = c(884,885),
                                     pelndad = c(886,887),
                                     pelnmom = c(888,889),
                                     pedadtyp = c(890,891),
                                     pemomtyp = c(892,893),
                                     pecohab = c(894,895),
                                     pxlndad = c(896,897),
                                     pxlnmom = c(898,899),
                                     pxdadtyp = c(900,901),
                                     pxmomtyp = c(902,903),
                                     pxcohab = c(904,905),
                                     pedisear = c(906,907),
                                     pediseye = c(908,909),
                                     pedisrem = c(910,911),
                                     pedisphy = c(912,913),
                                     pedisdrs = c(914,915),
                                     pedisout = c(916,917),
                                     prdisflg = c(918,919),
                                     pxdisear = c(920,921),
                                     pxdiseye = c(922,923),
                                     pxdisrem = c(924,925),
                                     pxdisphy = c(926,927),
                                     pxdisdrs = c(928,929),
                                     pxdisout = c(930,931),
                                     hxfaminc = c(932,933),
                                     pesd1 = c(951,952),
                                     pesd2 = c(953,954),
                                     pesd3 = c(955,956),
                                     pesd4 = c(957,958),
                                     pesd5 = c(959,960),
                                     pesd6 = c(961,962),
                                     pescow1 = c(963,964),
                                     pes1icd = c(965,968),
                                     prsdind = c(969,970),
                                     pes1ocd = c(971,974),
                                     prsdocc = c(975,976),
                                     pesd16 = c(977,978),
                                     pesd17 = c(979,980),
                                     ptsd18a = c(981,982),
                                     pesd18b = c(983,984),
                                     pesd19 = c(985,986),
                                     pesle1o = c(987,988),
                                     pesle2 = c(989,990),
                                     pesenh1o = c(991,994),
                                     ptsenh1o = c(995,996),
                                     ptsle4o = c(997,998),
                                     pusle5 = c(999,1000),
                                     putsle6 = c(1001,1002),
                                     pusle6d = c(1003,1004),
                                     pusern = c(1005,1010),
                                     pusern2 = c(1011,1016),
                                     ptsern = c(1017,1018),
                                     ptsern2 = c(1019,1020),
                                     pesle22 = c(1021,1022),
                                     pesd20 = c(1023,1024),
                                     pesd21 = c(1025,1026),
                                     pesd22 = c(1027,1028),
                                     pesd23 = c(1029,1030),
                                     pesd24 = c(1031,1032),
                                     ptsd25 = c(1033,1035),
                                     pesd26 = c(1036,1037),
                                     pesd27 = c(1038,1039),
                                     pesce2o = c(1040,1041),
                                     pesce3 = c(1042,1043),
                                     peseh1oa = c(1044,1047),
                                     ptseh1oa = c(1048,1049),
                                     putsce5 = c(1050,1051),
                                     ptsce5o = c(1052,1053),
                                     pusce6 = c(1054,1055),
                                     putsce7 = c(1056,1057),
                                     pusce8 = c(1058,1059),
                                     pusern1 = c(1060,1065),
                                     pusern2a = c(1066,1071),
                                     ptsern1 = c(1072,1073),
                                     ptsern2a = c(1074,1075),
                                     pesce25 = c(1076,1077),
                                     prslwkly = c(1078,1083),
                                     ptslwkly = c(1084,1085),
                                     prscwkly = c(1086,1091),
                                     ptscwkly = c(1092,1093),
                                     peshry = c(1094,1095),
                                     prshr = c(1096,1099),
                                     prsupern = c(1100,1101),
                                     ptst1a = c(1102,1104),
                                     pest1b = c(1105,1106),
                                     pest3 = c(1107,1108),
                                     pest7 = c(1109,1110),
                                     pest8 = c(1111,1112),
                                     pescow2 = c(1113,1114),
                                     pes2icd = c(1115,1118),
                                     prsd2ind = c(1119,1120),
                                     pes2ocd = c(1121,1124),
                                     prsd2occ = c(1125,1126),
                                     pest20 = c(1127,1128),
                                     pusd7 = c(1129,1130),
                                     pest25 = c(1131,1132),
                                     pest26 = c(1133,1134),
                                     pest27 = c(1135,1136),
                                     pest31 = c(1137,1138),
                                     prsupsat = c(1139,1140),
                                     pwsupwgt = c(1141,1150),
                                     prtensat = c(1151,1152),
                                     pwtenwgt = c(1153,1162),
                                     ptst1tn = c(1163,1166),
                                     ptsd18tn = c(1167,1170),
                                     prdispwk = c(1171,1172)))

      } else if (year == 2015 || year == 2016) {
          read_fwf(file_name, fwf_cols(hrhhid = c(1,15),
                                       hrmonth = c(16,17),
                                       hryear4 = c(18,21),
                                       hurespli = c(22,23),
                                       hufinal = c(24,26),
                                       huspnish = c(27,28),
                                       hetenure = c(29,30),
                                       hehousut = c(31,32),
                                       hetelhhd = c(33,34),
                                       hetelavl = c(35,36),
                                       hephoneo = c(37,38),
                                       hefaminc = c(39,40),
                                       hutypea = c(41,42),
                                       hutypb = c(43,44),
                                       hutypc = c(45,46),
                                       hwhhwgt = c(47,56),
                                       hrintsta = c(57,58),
                                       hrnumhou = c(59,60),
                                       hrhtype = c(61,62),
                                       hrmis = c(63,64),
                                       huinttyp = c(65,66),
                                       huprscnt = c(67,68),
                                       hrlonglk = c(69,70),
                                       hrhhid2 = c(71,75),
                                       hwhhwtln = c(76,77),
                                       hubus = c(79,80),
                                       hubusl1 = c(81,82),
                                       hubusl2 = c(83,84),
                                       hubusl3 = c(85,86),
                                       hubusl4 = c(87,88),
                                       gereg = c(89,90),
                                       gediv = c(91,91),
                                       gestfips = c(93,94),
                                       gtcbsa = c(96,100),
                                       gtco = c(101,103),
                                       gtcbsast = c(104,104),
                                       gtmetsta = c(105,105),
                                       gtindvpc = c(106,106),
                                       gtcbsasz = c(107,107),
                                       gtcsa = c(108,110),
                                       perrp = c(118,119),
                                       peparent = c(120,121),
                                       prtage = c(122,123),
                                       prtfage = c(124,124),
                                       pemaritl = c(125,126),
                                       pespouse = c(127,128),
                                       pesex = c(129,130),
                                       peafever = c(131,132),
                                       peafnow = c(135,136),
                                       peeduca = c(137,138),
                                       ptdtrace = c(139,140),
                                       prdthsp = c(141,142),
                                       puchinhh = c(143,144),
                                       pulineno = c(147,148),
                                       prfamnum = c(151,152),
                                       prfamrel = c(153,154),
                                       prfamtyp = c(155,156),
                                       pehspnon = c(157,158),
                                       prmarsta = c(159,160),
                                       prpertyp = c(161,162),
                                       penatvty = c(163,165),
                                       pemntvty = c(166,168),
                                       pefntvty = c(169,171),
                                       prcitshp = c(172,173),
                                       prcitflg = c(174,175),
                                       prinusyr = c(176,177),
                                       puslfprx = c(178,179),
                                       pemlr = c(180,181),
                                       puwk = c(182,183),
                                       pubus1 = c(184,185),
                                       pubus2ot = c(186,187),
                                       pubusck1 = c(188,189),
                                       pubusck2 = c(190,191),
                                       pubusck3 = c(192,193),
                                       pubusck4 = c(194,195),
                                       puretot = c(196,197),
                                       pudis = c(198,199),
                                       peret1 = c(200,201),
                                       pudis1 = c(202,203),
                                       pudis2 = c(204,205),
                                       puabsot = c(206,207),
                                       pulay = c(208,209),
                                       peabsrsn = c(210,211),
                                       peabspdo = c(212,213),
                                       pemjot = c(214,215),
                                       pemjnum = c(216,217),
                                       pehrusl1 = c(218,219),
                                       pehrusl2 = c(220,221),
                                       pehrftpt = c(222,223),
                                       pehruslt = c(224,226),
                                       pehrwant = c(227,228),
                                       pehrrsn1 = c(229,230),
                                       pehrrsn2 = c(231,232),
                                       pehrrsn3 = c(233,234),
                                       puhroff1 = c(235,236),
                                       puhroff2 = c(237,238),
                                       puhrot1 = c(239,240),
                                       puhrot2 = c(241,242),
                                       pehract1 = c(243,244),
                                       pehract2 = c(245,246),
                                       pehractt = c(247,249),
                                       pehravl = c(250,251),
                                       puhrck1 = c(257,258),
                                       puhrck2 = c(259,260),
                                       puhrck3 = c(261,262),
                                       puhrck4 = c(263,264),
                                       puhrck5 = c(265,266),
                                       puhrck6 = c(267,268),
                                       puhrck7 = c(269,270),
                                       puhrck12 = c(271,272),
                                       pulaydt = c(273,274),
                                       pulay6m = c(275,276),
                                       pelayavl = c(277,278),
                                       pulayavr = c(279,280),
                                       pelaylk = c(281,282),
                                       pelaydur = c(283,285),
                                       pelayfto = c(286,287),
                                       pulayck1 = c(288,289),
                                       pulayck2 = c(290,291),
                                       pulayck3 = c(292,293),
                                       pulk = c(294,295),
                                       pelkm1 = c(296,297),
                                       pulkm2 = c(298,299),
                                       pulkm3 = c(300,301),
                                       pulkm4 = c(302,303),
                                       pulkm5 = c(304,305),
                                       pulkm6 = c(306,307),
                                       pulkdk1 = c(308,309),
                                       pulkdk2 = c(310,311),
                                       pulkdk3 = c(312,313),
                                       pulkdk4 = c(314,315),
                                       pulkdk5 = c(316,317),
                                       pulkdk6 = c(318,319),
                                       pulkps1 = c(320,321),
                                       pulkps2 = c(322,323),
                                       pulkps3 = c(324,325),
                                       pulkps4 = c(326,327),
                                       pulkps5 = c(328,329),
                                       pulkps6 = c(330,331),
                                       pelkavl = c(332,333),
                                       pulkavr = c(334,335),
                                       pelkll1o = c(336,337),
                                       pelkll2o = c(338,339),
                                       pelklwo = c(340,341),
                                       pelkdur = c(342,344),
                                       pelkfto = c(345,346),
                                       pedwwnto = c(347,348),
                                       pedwrsn = c(349,350),
                                       pedwlko = c(351,352),
                                       pedwwk = c(353,354),
                                       pedw4wk = c(355,356),
                                       pedwlkwk = c(357,358),
                                       pedwavl = c(359,360),
                                       pedwavr = c(361,362),
                                       pudwck1 = c(363,364),
                                       pudwck2 = c(365,366),
                                       pudwck3 = c(367,368),
                                       pudwck4 = c(369,370),
                                       pudwck5 = c(371,372),
                                       pejhwko = c(373,374),
                                       pujhdp1o = c(375,376),
                                       pejhrsn = c(377,378),
                                       pejhwant = c(379,380),
                                       pujhck1 = c(381,382),
                                       pujhck2 = c(383,384),
                                       prabsrea = c(385,386),
                                       prcivlf = c(387,388),
                                       prdisc = c(389,390),
                                       premphrs = c(391,392),
                                       prempnot = c(393,394),
                                       prexplf = c(395,396),
                                       prftlf = c(397,398),
                                       prhrusl = c(399,400),
                                       prjobsea = c(401,402),
                                       prpthrs = c(403,404),
                                       prptrea = c(405,406),
                                       prunedur = c(407,409),
                                       pruntype = c(412,413),
                                       prwksch = c(414,415),
                                       prwkstat = c(416,417),
                                       prwntjob = c(418,419),
                                       pujhck3 = c(420,421),
                                       pujhck4 = c(422,423),
                                       pujhck5 = c(424,425),
                                       puiodp1 = c(426,427),
                                       puiodp2 = c(428,429),
                                       puiodp3 = c(430,431),
                                       peio1cow = c(432,433),
                                       puio1mfg = c(434,435),
                                       peio2cow = c(442,443),
                                       puio2mfg = c(444,445),
                                       puiock1 = c(452,453),
                                       puiock2 = c(454,455),
                                       puiock3 = c(456,457),
                                       prioelg = c(458,459),
                                       pragna = c(460,461),
                                       prcow1 = c(462,463),
                                       prcow2 = c(464,465),
                                       prcowpg = c(466,467),
                                       prdtcow1 = c(468,469),
                                       prdtcow2 = c(470,471),
                                       prdtind1 = c(472,473),
                                       prdtind2 = c(474,475),
                                       prdtocc1 = c(476,477),
                                       prdtocc2 = c(478,479),
                                       premp = c(480,481),
                                       prmjind1 = c(482,483),
                                       prmjind2 = c(484,485),
                                       prmjocc1 = c(486,487),
                                       prmjocc2 = c(488,489),
                                       prmjocgr = c(490,491),
                                       prnagpws = c(492,493),
                                       prnagws = c(494,495),
                                       prsjmj = c(496,497),
                                       prerelg = c(498,499),
                                       peernuot = c(500,501),
                                       peernper = c(502,503),
                                       peernrt = c(504,505),
                                       peernhry = c(506,507),
                                       puernh1c = c(508,511),
                                       peernh2 = c(512,515),
                                       peernh1o = c(516,519),
                                       prernhly = c(520,523),
                                       pthr = c(524,524),
                                       peernhro = c(525,526),
                                       prernwa = c(527,534),
                                       ptwk = c(535,535),
                                       peern = c(540,547),
                                       puern2 = c(548,555),
                                       ptot = c(556,556),
                                       peernwkp = c(559,560),
                                       peernlab = c(561,562),
                                       peerncov = c(563,564),
                                       penlfjh = c(565,566),
                                       penlfret = c(567,568),
                                       penlfact = c(569,570),
                                       punlfck1 = c(571,572),
                                       punlfck2 = c(573,574),
                                       peschenr = c(575,576),
                                       peschft = c(577,578),
                                       peschlvl = c(579,580),
                                       prnlfsch = c(581,582),
                                       pwfmwgt = c(583,592),
                                       pwlgwgt = c(593,602),
                                       pworwgt = c(603,612),
                                       pwsswgt = c(613,622),
                                       pwvetwgt = c(623,632),
                                       prchld = c(633,634),
                                       prnmchld = c(635,636),
                                       pxpdemp1 = c(637,638),
                                       prwernal = c(639,640),
                                       prhernal = c(641,642),
                                       hxtenure = c(643,644),
                                       hxhousut = c(645,646),
                                       hxtelhhd = c(647,648),
                                       hxtelavl = c(649,650),
                                       hxphoneo = c(651,652),
                                       pxinusyr = c(653,654),
                                       pxrrp = c(655,656),
                                       pxparent = c(657,658),
                                       pxage = c(659,660),
                                       pxmaritl = c(661,662),
                                       pxspouse = c(663,664),
                                       pxsex = c(665,666),
                                       pxafwhn1 = c(667,668),
                                       pxafnow = c(669,670),
                                       pxeduca = c(671,672),
                                       pxrace1 = c(673,674),
                                       pxnatvty = c(675,676),
                                       pxmntvty = c(677,678),
                                       pxfntvty = c(679,680),
                                       pxnmemp1 = c(681,682),
                                       pxhspnon = c(683,684),
                                       pxmlr = c(685,686),
                                       pxret1 = c(687,688),
                                       pxabsrsn = c(689,690),
                                       pxabspdo = c(691,692),
                                       pxmjot = c(693,694),
                                       pxmjnum = c(695,696),
                                       pxhrusl1 = c(697,698),
                                       pxhrusl2 = c(699,700),
                                       pxhrftpt = c(701,702),
                                       pxhruslt = c(703,704),
                                       pxhrwant = c(705,706),
                                       pxhrrsn1 = c(707,708),
                                       pxhrrsn2 = c(709,710),
                                       pxhract1 = c(711,712),
                                       pxhract2 = c(713,714),
                                       pxhractt = c(715,716),
                                       pxhrrsn3 = c(717,718),
                                       pxhravl = c(719,720),
                                       pxlayavl = c(721,722),
                                       pxlaylk = c(723,724),
                                       pxlaydur = c(725,726),
                                       pxlayfto = c(727,728),
                                       pxlkm1 = c(729,730),
                                       pxlkavl = c(731,732),
                                       pxlkll1o = c(733,734),
                                       pxlkll2o = c(735,736),
                                       pxlklwo = c(737,738),
                                       pxlkdur = c(739,740),
                                       pxlkfto = c(741,742),
                                       pxdwwnto = c(743,744),
                                       pxdwrsn = c(745,746),
                                       pxdwlko = c(747,748),
                                       pxdwwk = c(749,750),
                                       pxdw4wk = c(751,752),
                                       pxdwlkwk = c(753,754),
                                       pxdwavl = c(755,756),
                                       pxdwavr = c(757,758),
                                       pxjhwko = c(759,760),
                                       pxjhrsn = c(761,762),
                                       pxjhwant = c(763,764),
                                       pxio1cow = c(765,766),
                                       pxio1icd = c(767,768),
                                       pxio1ocd = c(769,770),
                                       pxio2cow = c(771,772),
                                       pxio2icd = c(773,774),
                                       pxio2ocd = c(775,776),
                                       pxernuot = c(777,778),
                                       pxernper = c(779,780),
                                       pxernh1o = c(781,782),
                                       pxernhro = c(783,784),
                                       pxern = c(785,786),
                                       pxpdemp2 = c(787,788),
                                       pxnmemp2 = c(789,790),
                                       pxernwkp = c(791,792),
                                       pxernrt = c(793,794),
                                       pxernhry = c(795,796),
                                       pxernh2 = c(797,798),
                                       pxernlab = c(799,800),
                                       pxerncov = c(801,802),
                                       pxnlfjh = c(803,804),
                                       pxnlfret = c(805,806),
                                       pxnlfact = c(807,808),
                                       pxschenr = c(809,810),
                                       pxschft = c(811,812),
                                       pxschlvl = c(813,814),
                                       qstnum = c(815,819),
                                       occurnum = c(820,821),
                                       pedipged = c(822,823),
                                       pehgcomp = c(824,825),
                                       pecyc = c(826,827),
                                       pxdipged = c(834,835),
                                       pxhgcomp = c(836,837),
                                       pxcyc = c(838,839),
                                       pwcmpwgt = c(846,855),
                                       peio1icd = c(856,859),
                                       peio1ocd = c(860,863),
                                       peio2icd = c(864,867),
                                       peio2ocd = c(868,871),
                                       primind1 = c(872,873),
                                       primind2 = c(874,875),
                                       peafwhn1 = c(876,877),
                                       peafwhn2 = c(878,879),
                                       peafwhn3 = c(880,881),
                                       peafwhn4 = c(882,883),
                                       pxafever = c(884,885),
                                       pelndad = c(886,887),
                                       pelnmom = c(888,889),
                                       pedadtyp = c(890,891),
                                       pemomtyp = c(892,893),
                                       pecohab = c(894,895),
                                       pxlndad = c(896,897),
                                       pxlnmom = c(898,899),
                                       pxdadtyp = c(900,901),
                                       pxmomtyp = c(902,903),
                                       pxcohab = c(904,905),
                                       pedisear = c(906,907),
                                       pediseye = c(908,909),
                                       pedisrem = c(910,911),
                                       pedisphy = c(912,913),
                                       pedisdrs = c(914,915),
                                       pedisout = c(916,917),
                                       prdisflg = c(918,919),
                                       pxdisear = c(920,921),
                                       pxdiseye = c(922,923),
                                       pxdisrem = c(924,925),
                                       pxdisphy = c(926,927),
                                       pxdisdrs = c(928,929),
                                       pxdisout = c(930,931),
                                       hxfaminc = c(932,933),
                                       prdasian = c(934,935),
                                       pepdemp1 = c(936,937),
                                       ptnmemp1 = c(938,939),
                                       pepdemp2 = c(940,941),
                                       ptnmemp2 = c(942,943),
                                       pesd1 = c(951,952),
                                       pesd2 = c(953,954),
                                       pesd3 = c(955,956),
                                       pesd4 = c(957,958),
                                       pesd5 = c(959,960),
                                       pesd6 = c(961,962),
                                       pescow1 = c(963,964),
                                       pes1icd = c(965,968),
                                       prsdind = c(969,970),
                                       pes1ocd = c(971,974),
                                       prsdocc = c(975,976),
                                       pesd16 = c(977,978),
                                       pesd17 = c(979,980),
                                       ptsd18a = c(981,982),
                                       pesd18b = c(983,984),
                                       pesd19 = c(985,986),
                                       pesle1o = c(987,988),
                                       pesle2 = c(989,990),
                                       pesenh1o = c(991,994),
                                       ptsenh1o = c(995,996),
                                       ptsle4o = c(997,998),
                                       pusle5 = c(999,1000),
                                       putsle6 = c(1001,1002),
                                       pusle6d = c(1003,1004),
                                       pusern = c(1005,1010),
                                       pusern2 = c(1011,1016),
                                       ptsern = c(1017,1018),
                                       ptsern2 = c(1019,1020),
                                       pesle22 = c(1021,1022),
                                       pesd20 = c(1023,1024),
                                       pesd21 = c(1025,1026),
                                       pesd22 = c(1027,1028),
                                       pesd23 = c(1029,1030),
                                       pesd24 = c(1031,1032),
                                       ptsd25 = c(1033,1035),
                                       pesd26 = c(1036,1037),
                                       pesd27 = c(1038,1039),
                                       pesce2o = c(1040,1041),
                                       pesce3 = c(1042,1043),
                                       peseh1oa = c(1044,1047),
                                       ptseh1oa = c(1048,1049),
                                       putsce5 = c(1050,1051),
                                       ptsce5o = c(1052,1053),
                                       pusce6 = c(1054,1055),
                                       putsce7 = c(1056,1057),
                                       pusce8 = c(1058,1059),
                                       pusern1 = c(1060,1065),
                                       pusern2a = c(1066,1071),
                                       ptsern1 = c(1072,1073),
                                       ptsern2a = c(1074,1075),
                                       pesce25 = c(1076,1077),
                                       prslwkly = c(1078,1083),
                                       ptslwkly = c(1084,1085),
                                       prscwkly = c(1086,1091),
                                       ptscwkly = c(1092,1093),
                                       peshry = c(1094,1095),
                                       prshr = c(1096,1099),
                                       prsupern = c(1100,1101),
                                       ptst1a = c(1102,1104),
                                       pest1b = c(1105,1106),
                                       pest3 = c(1107,1108),
                                       pest7 = c(1109,1110),
                                       pest8 = c(1111,1112),
                                       pescow2 = c(1113,1114),
                                       pes2icd = c(1115,1118),
                                       prsd2ind = c(1119,1120),
                                       pes2ocd = c(1121,1124),
                                       prsd2occ = c(1125,1126),
                                       pest20 = c(1127,1128),
                                       pusd7 = c(1129,1130),
                                       pest25 = c(1131,1132),
                                       pest26 = c(1133,1134),
                                       pest27 = c(1135,1136),
                                       pest31 = c(1137,1138),
                                       prsupsat = c(1139,1140),
                                       pwsupwgt = c(1141,1150),
                                       prtensat = c(1151,1152),
                                       pwtenwgt = c(1153,1162),
                                       ptst1tn = c(1163,1166),
                                       ptsd18tn = c(1167,1170),
                                       prdispwk = c(1171,1172)))

      } else if (year == 2017 || year == 2018 || year == 2019) {
          read_fwf(file_name, fwf_cols(hrhhid = c(1,15),
                                     hrmonth = c(16,17),
                                     hryear4 = c(18,21),
                                     hurespli = c(22,23),
                                     hufinal = c(24,26),
                                     hetenure = c(29,30),
                                     hehousut = c(31,32),
                                     hetelhhd = c(33,34),
                                     hetelavl = c(35,36),
                                     hephoneo = c(37,38),
                                     hefaminc = c(39,40),
                                     hutypea = c(41,42),
                                     hutypb = c(43,44),
                                     hutypc = c(45,46),
                                     hwhhwgt = c(47,56),
                                     hrintsta = c(57,58),
                                     hrnumhou = c(59,60),
                                     hrhtype = c(61,62),
                                     hrmis = c(63,64),
                                     huinttyp = c(65,66),
                                     huprscnt = c(67,68),
                                     hrlonglk = c(69,70),
                                     hrhhid2 = c(71,75),
                                     hwhhwtln = c(76,77),
                                     hubus = c(79,80),
                                     hubusl1 = c(81,82),
                                     hubusl2 = c(83,84),
                                     hubusl3 = c(85,86),
                                     hubusl4 = c(87,88),
                                     gereg = c(89,90),
                                     gediv = c(91,91),
                                     gestfips = c(93,94),
                                     gtcbsa = c(96,100),
                                     gtco = c(101,103),
                                     gtcbsast = c(104,104),
                                     gtmetsta = c(105,105),
                                     gtindvpc = c(106,106),
                                     gtcbsasz = c(107,107),
                                     gtcsa = c(108,110),
                                     perrp = c(118,119),
                                     peparent = c(120,121),
                                     prtage = c(122,123),
                                     prtfage = c(124,124),
                                     pemaritl = c(125,126),
                                     pespouse = c(127,128),
                                     pesex = c(129,130),
                                     peafever = c(131,132),
                                     peafnow = c(135,136),
                                     peeduca = c(137,138),
                                     ptdtrace = c(139,140),
                                     prdthsp = c(141,142),
                                     puchinhh = c(143,144),
                                     pulineno = c(147,148),
                                     prfamnum = c(151,152),
                                     prfamrel = c(153,154),
                                     prfamtyp = c(155,156),
                                     pehspnon = c(157,158),
                                     prmarsta = c(159,160),
                                     prpertyp = c(161,162),
                                     penatvty = c(163,165),
                                     pemntvty = c(166,168),
                                     pefntvty = c(169,171),
                                     prcitshp = c(172,173),
                                     prcitflg = c(174,175),
                                     prinusyr = c(176,177),
                                     puslfprx = c(178,179),
                                     pemlr = c(180,181),
                                     puwk = c(182,183),
                                     pubus1 = c(184,185),
                                     pubus2ot = c(186,187),
                                     pubusck1 = c(188,189),
                                     pubusck2 = c(190,191),
                                     pubusck3 = c(192,193),
                                     pubusck4 = c(194,195),
                                     puretot = c(196,197),
                                     pudis = c(198,199),
                                     peret1 = c(200,201),
                                     pudis1 = c(202,203),
                                     pudis2 = c(204,205),
                                     puabsot = c(206,207),
                                     pulay = c(208,209),
                                     peabsrsn = c(210,211),
                                     peabspdo = c(212,213),
                                     pemjot = c(214,215),
                                     pemjnum = c(216,217),
                                     pehrusl1 = c(218,219),
                                     pehrusl2 = c(220,221),
                                     pehrftpt = c(222,223),
                                     pehruslt = c(224,226),
                                     pehrwant = c(227,228),
                                     pehrrsn1 = c(229,230),
                                     pehrrsn2 = c(231,232),
                                     pehrrsn3 = c(233,234),
                                     puhroff1 = c(235,236),
                                     puhroff2 = c(237,238),
                                     puhrot1 = c(239,240),
                                     puhrot2 = c(241,242),
                                     pehract1 = c(243,244),
                                     pehract2 = c(245,246),
                                     pehractt = c(247,249),
                                     pehravl = c(250,251),
                                     puhrck1 = c(257,258),
                                     puhrck2 = c(259,260),
                                     puhrck3 = c(261,262),
                                     puhrck4 = c(263,264),
                                     puhrck5 = c(265,266),
                                     puhrck6 = c(267,268),
                                     puhrck7 = c(269,270),
                                     puhrck12 = c(271,272),
                                     pulaydt = c(273,274),
                                     pulay6m = c(275,276),
                                     pelayavl = c(277,278),
                                     pulayavr = c(279,280),
                                     pelaylk = c(281,282),
                                     pelaydur = c(283,285),
                                     pelayfto = c(286,287),
                                     pulayck1 = c(288,289),
                                     pulayck2 = c(290,291),
                                     pulayck3 = c(292,293),
                                     pulk = c(294,295),
                                     pelkm1 = c(296,297),
                                     pulkm2 = c(298,299),
                                     pulkm3 = c(300,301),
                                     pulkm4 = c(302,303),
                                     pulkm5 = c(304,305),
                                     pulkm6 = c(306,307),
                                     pulkdk1 = c(308,309),
                                     pulkdk2 = c(310,311),
                                     pulkdk3 = c(312,313),
                                     pulkdk4 = c(314,315),
                                     pulkdk5 = c(316,317),
                                     pulkdk6 = c(318,319),
                                     pulkps1 = c(320,321),
                                     pulkps2 = c(322,323),
                                     pulkps3 = c(324,325),
                                     pulkps4 = c(326,327),
                                     pulkps5 = c(328,329),
                                     pulkps6 = c(330,331),
                                     pelkavl = c(332,333),
                                     pulkavr = c(334,335),
                                     pelkll1o = c(336,337),
                                     pelkll2o = c(338,339),
                                     pelklwo = c(340,341),
                                     pelkdur = c(342,344),
                                     pelkfto = c(345,346),
                                     pedwwnto = c(347,348),
                                     pedwrsn = c(349,350),
                                     pedwlko = c(351,352),
                                     pedwwk = c(353,354),
                                     pedw4wk = c(355,356),
                                     pedwlkwk = c(357,358),
                                     pedwavl = c(359,360),
                                     pedwavr = c(361,362),
                                     pudwck1 = c(363,364),
                                     pudwck2 = c(365,366),
                                     pudwck3 = c(367,368),
                                     pudwck4 = c(369,370),
                                     pudwck5 = c(371,372),
                                     pejhwko = c(373,374),
                                     pujhdp1o = c(375,376),
                                     pejhrsn = c(377,378),
                                     pejhwant = c(379,380),
                                     pujhck1 = c(381,382),
                                     pujhck2 = c(383,384),
                                     prabsrea = c(385,386),
                                     prcivlf = c(387,388),
                                     prdisc = c(389,390),
                                     premphrs = c(391,392),
                                     prempnot = c(393,394),
                                     prexplf = c(395,396),
                                     prftlf = c(397,398),
                                     prhrusl = c(399,400),
                                     prjobsea = c(401,402),
                                     prpthrs = c(403,404),
                                     prptrea = c(405,406),
                                     prunedur = c(407,409),
                                     pruntype = c(412,413),
                                     prwksch = c(414,415),
                                     prwkstat = c(416,417),
                                     prwntjob = c(418,419),
                                     pujhck3 = c(420,421),
                                     pujhck4 = c(422,423),
                                     pujhck5 = c(424,425),
                                     puiodp1 = c(426,427),
                                     puiodp2 = c(428,429),
                                     puiodp3 = c(430,431),
                                     peio1cow = c(432,433),
                                     puio1mfg = c(434,435),
                                     peio2cow = c(442,443),
                                     puio2mfg = c(444,445),
                                     puiock1 = c(452,453),
                                     puiock2 = c(454,455),
                                     puiock3 = c(456,457),
                                     prioelg = c(458,459),
                                     pragna = c(460,461),
                                     prcow1 = c(462,463),
                                     prcow2 = c(464,465),
                                     prcowpg = c(466,467),
                                     prdtcow1 = c(468,469),
                                     prdtcow2 = c(470,471),
                                     prdtind1 = c(472,473),
                                     prdtind2 = c(474,475),
                                     prdtocc1 = c(476,477),
                                     prdtocc2 = c(478,479),
                                     premp = c(480,481),
                                     prmjind1 = c(482,483),
                                     prmjind2 = c(484,485),
                                     prmjocc1 = c(486,487),
                                     prmjocc2 = c(488,489),
                                     prmjocgr = c(490,491),
                                     prnagpws = c(492,493),
                                     prnagws = c(494,495),
                                     prsjmj = c(496,497),
                                     prerelg = c(498,499),
                                     peernuot = c(500,501),
                                     peernper = c(502,503),
                                     peernrt = c(504,505),
                                     peernhry = c(506,507),
                                     puernh1c = c(508,511),
                                     peernh2 = c(512,515),
                                     peernh1o = c(516,519),
                                     prernhly = c(520,523),
                                     pthr = c(524,524),
                                     peernhro = c(525,526),
                                     prernwa = c(527,534),
                                     ptwk = c(535,535),
                                     peern = c(540,547),
                                     puern2 = c(548,555),
                                     ptot = c(556,556),
                                     peernwkp = c(559,560),
                                     peernlab = c(561,562),
                                     peerncov = c(563,564),
                                     penlfjh = c(565,566),
                                     penlfret = c(567,568),
                                     penlfact = c(569,570),
                                     punlfck1 = c(571,572),
                                     punlfck2 = c(573,574),
                                     peschenr = c(575,576),
                                     peschft = c(577,578),
                                     peschlvl = c(579,580),
                                     prnlfsch = c(581,582),
                                     pwfmwgt = c(583,592),
                                     pwlgwgt = c(593,602),
                                     pworwgt = c(603,612),
                                     pwsswgt = c(613,622),
                                     pwvetwgt = c(623,632),
                                     prchld = c(633,634),
                                     prnmchld = c(635,636),
                                     pxpdemp1 = c(637,638),
                                     prwernal = c(639,640),
                                     prhernal = c(641,642),
                                     hxtenure = c(643,644),
                                     hxhousut = c(645,646),
                                     hxtelhhd = c(647,648),
                                     hxtelavl = c(649,650),
                                     hxphoneo = c(651,652),
                                     pxinusyr = c(653,654),
                                     pxrrp = c(655,656),
                                     pxparent = c(657,658),
                                     pxage = c(659,660),
                                     pxmaritl = c(661,662),
                                     pxspouse = c(663,664),
                                     pxsex = c(665,666),
                                     pxafwhn1 = c(667,668),
                                     pxafnow = c(669,670),
                                     pxeduca = c(671,672),
                                     pxrace1 = c(673,674),
                                     pxnatvty = c(675,676),
                                     pxmntvty = c(677,678),
                                     pxfntvty = c(679,680),
                                     pxnmemp1 = c(681,682),
                                     pxhspnon = c(683,684),
                                     pxmlr = c(685,686),
                                     pxret1 = c(687,688),
                                     pxabsrsn = c(689,690),
                                     pxabspdo = c(691,692),
                                     pxmjot = c(693,694),
                                     pxmjnum = c(695,696),
                                     pxhrusl1 = c(697,698),
                                     pxhrusl2 = c(699,700),
                                     pxhrftpt = c(701,702),
                                     pxhruslt = c(703,704),
                                     pxhrwant = c(705,706),
                                     pxhrrsn1 = c(707,708),
                                     pxhrrsn2 = c(709,710),
                                     pxhract1 = c(711,712),
                                     pxhract2 = c(713,714),
                                     pxhractt = c(715,716),
                                     pxhrrsn3 = c(717,718),
                                     pxhravl = c(719,720),
                                     pxlayavl = c(721,722),
                                     pxlaylk = c(723,724),
                                     pxlaydur = c(725,726),
                                     pxlayfto = c(727,728),
                                     pxlkm1 = c(729,730),
                                     pxlkavl = c(731,732),
                                     pxlkll1o = c(733,734),
                                     pxlkll2o = c(735,736),
                                     pxlklwo = c(737,738),
                                     pxlkdur = c(739,740),
                                     pxlkfto = c(741,742),
                                     pxdwwnto = c(743,744),
                                     pxdwrsn = c(745,746),
                                     pxdwlko = c(747,748),
                                     pxdwwk = c(749,750),
                                     pxdw4wk = c(751,752),
                                     pxdwlkwk = c(753,754),
                                     pxdwavl = c(755,756),
                                     pxdwavr = c(757,758),
                                     pxjhwko = c(759,760),
                                     pxjhrsn = c(761,762),
                                     pxjhwant = c(763,764),
                                     pxio1cow = c(765,766),
                                     pxio1icd = c(767,768),
                                     pxio1ocd = c(769,770),
                                     pxio2cow = c(771,772),
                                     pxio2icd = c(773,774),
                                     pxio2ocd = c(775,776),
                                     pxernuot = c(777,778),
                                     pxernper = c(779,780),
                                     pxernh1o = c(781,782),
                                     pxernhro = c(783,784),
                                     pxern = c(785,786),
                                     pxpdemp2 = c(787,788),
                                     pxnmemp2 = c(789,790),
                                     pxernwkp = c(791,792),
                                     pxernrt = c(793,794),
                                     pxernhry = c(795,796),
                                     pxernh2 = c(797,798),
                                     pxernlab = c(799,800),
                                     pxerncov = c(801,802),
                                     pxnlfjh = c(803,804),
                                     pxnlfret = c(805,806),
                                     pxnlfact = c(807,808),
                                     pxschenr = c(809,810),
                                     pxschft = c(811,812),
                                     pxschlvl = c(813,814),
                                     qstnum = c(815,819),
                                     occurnum = c(820,821),
                                     pedipged = c(822,823),
                                     pehgcomp = c(824,825),
                                     pecyc = c(826,827),
                                     pxdipged = c(834,835),
                                     pxhgcomp = c(836,837),
                                     pxcyc = c(838,839),
                                     pwcmpwgt = c(846,855),
                                     peio1icd = c(856,859),
                                     peio1ocd = c(860,863),
                                     peio2icd = c(864,867),
                                     peio2ocd = c(868,871),
                                     primind1 = c(872,873),
                                     primind2 = c(874,875),
                                     peafwhn1 = c(876,877),
                                     peafwhn2 = c(878,879),
                                     peafwhn3 = c(880,881),
                                     peafwhn4 = c(882,883),
                                     pxafever = c(884,885),
                                     pelndad = c(886,887),
                                     pelnmom = c(888,889),
                                     pedadtyp = c(890,891),
                                     pemomtyp = c(892,893),
                                     pecohab = c(894,895),
                                     pxlndad = c(896,897),
                                     pxlnmom = c(898,899),
                                     pxdadtyp = c(900,901),
                                     pxmomtyp = c(902,903),
                                     pxcohab = c(904,905),
                                     pedisear = c(906,907),
                                     pediseye = c(908,909),
                                     pedisrem = c(910,911),
                                     pedisphy = c(912,913),
                                     pedisdrs = c(914,915),
                                     pedisout = c(916,917),
                                     prdisflg = c(918,919),
                                     pxdisear = c(920,921),
                                     pxdiseye = c(922,923),
                                     pxdisrem = c(924,925),
                                     pxdisphy = c(926,927),
                                     pxdisdrs = c(928,929),
                                     pxdisout = c(930,931),
                                     hxfaminc = c(932,933),
                                     prdasian = c(934,935),
                                     pepdemp1 = c(936,937),
                                     ptnmemp1 = c(938,939),
                                     pepdemp2 = c(940,941),
                                     ptnmemp2 = c(942,943),
                                     pecert1 = c(944,945),
                                     pecert2 = c(946,947),
                                     pecert3 = c(948,949),
                                     pxcert1 = c(950,951),
                                     pxcert2 = c(952,953),
                                     pxcert3 = c(954,955),
                                     pesd1 = c(1001,1002),
                                     pesd2 = c(1003,1004),
                                     pesd3 = c(1005,1006),
                                     pesd4 = c(1007,1008),
                                     pesd5 = c(1009,1010),
                                     pesd6 = c(1011,1012),
                                     pescow1 = c(1013,1014),
                                     pes1icd = c(1015,1018),
                                     prsdind = c(1019,1020),
                                     pes1ocd = c(1021,1024),
                                     prsdocc = c(1025,1026),
                                     pesd16 = c(1027,1028),
                                     pesd17 = c(1029,1030),
                                     ptsd18a = c(1031,1032),
                                     pesd18b = c(1033,1034),
                                     pesd19 = c(1035,1036),
                                     pesle1o = c(1037,1038),
                                     pesle2 = c(1039,1040),
                                     pesenh1o = c(1041,1044),
                                     ptsenh1o = c(1045,1046),
                                     ptsle4o = c(1047,1048),
                                     pusle5 = c(1049,1050),
                                     putsle6 = c(1051,1052),
                                     pusle6d = c(1053,1054),
                                     pusern = c(1055,1060),
                                     pusern2 = c(1061,1066),
                                     ptsern = c(1067,1068),
                                     ptsern2 = c(1069,1070),
                                     pesle22 = c(1071,1072),
                                     pesd20 = c(1073,1074),
                                     pesd21 = c(1075,1076),
                                     pesd22 = c(1077,1078),
                                     pesd23 = c(1079,1080),
                                     pesd24 = c(1081,1082),
                                     ptsd25 = c(1083,1085),
                                     pesd26 = c(1086,1087),
                                     pesd27 = c(1088,1089),
                                     pesce2o = c(1090,1091),
                                     pesce3 = c(1092,1093),
                                     peseh1oa = c(1094,1097),
                                     ptseh1oa = c(1098,1099),
                                     putsce5 = c(1100,1101),
                                     ptsce5o = c(1102,1103),
                                     pusce6 = c(1104,1105),
                                     putsce7 = c(1106,1107),
                                     pusce8 = c(1108,1109),
                                     pusern1 = c(1110,1115),
                                     pusern2a = c(1116,1121),
                                     ptsern1 = c(1122,1123),
                                     ptsern2a = c(1124,1125),
                                     pesce25 = c(1126,1127),
                                     prslwkly = c(1128,1133),
                                     ptslwkly = c(1134,1135),
                                     prscwkly = c(1136,1141),
                                     ptscwkly = c(1142,1143),
                                     peshry = c(1144,1145),
                                     prshr = c(1146,1149),
                                     prsupern = c(1150,1151),
                                     ptst1a = c(1152,1154),
                                     pest1b = c(1155,1156),
                                     pest3 = c(1157,1158),
                                     pest7 = c(1159,1160),
                                     pest8 = c(1161,1162),
                                     pescow2 = c(1163,1164),
                                     pes2icd = c(1165,1168),
                                     prsd2ind = c(1169,1170),
                                     pes2ocd = c(1171,1174),
                                     prsd2occ = c(1175,1176),
                                     pest20 = c(1177,1178),
                                     pusd7 = c(1179,1180),
                                     pest25 = c(1181,1182),
                                     pest26 = c(1183,1184),
                                     pest27 = c(1185,1186),
                                     pest31 = c(1187,1188),
                                     prsupsat = c(1189,1190),
                                     pwsupwgt = c(1191,1200),
                                     prtensat = c(1201,1202),
                                     pwtenwgt = c(1203,1212),
                                     ptst1tn = c(1213,1216),
                                     ptsd18tn = c(1217,1220),
                                     prdispwk = c(1221,1222)))
      }

      print(paste0('>>2 Determining column widths for ', file_name_short, '.'))

      print('>>>3 Assigning variable names to dataframe.')

      print(">>>>4 Writing .csv file to working directory.")

      write.csv(cps_file, paste0('data/', substr(file_name_short, 1, 8), ".csv"), row.names = FALSE)
    }
  }
}

if(exists("input_year")) {
  rm(list = "input_year")
}
